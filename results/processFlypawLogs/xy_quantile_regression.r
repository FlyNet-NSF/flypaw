library("quantreg")
csv_data <- read.csv("power_distance_scatter.txt")
X <- csv_data$distance
Y <- csv_data$power
plot(Y ~ X, xlab = "Distance (m)", ylab = "Power (dB)", main = "Power vs Distance")
#modh <- rq(Y ~ log(X), data=csv_data, tau = .98)
modh <- rq.fit.br(x=X, y=Y, tau = .66, alpha= 0.1, ci=TRUE, iid=TRUE, interp=TRUE, tcrit=TRUE )
pDFh <- data.frame(X = seq(1, 500, length = 100))
pDFh <- within(pDFh, Y <- predict(modh, newdata = pDFh))
lines(Y ~ X, data = pDFh, col = "green", lwd = 2)
modl <- rq(Y ~ log(X), data=csv_data, tau = .02)
pDFl <- data.frame(X = seq(1, 500, length = 100))
pDFl <- within(pDFl, Y <- predict(modl, newdata = pDFl))
lines(Y ~ X, data = pDFl, col = "red", lwd = 2, lty = 2)
mod <- rq(Y ~ log(X), data=csv_data, tau = .5)
pDF <- data.frame(X = seq(1, 500, length = 100))
pDF <- within(pDF, Y <- predict(mod, newdata = pDF))
lines(Y ~ X, data = pDF, col = "blue", lwd = 2)
legend("bottomleft", legend=c("98% Quantile", "2% Quantile", "Median Power"), col=c("green","red","blue"), lty=1:2, cex=0.8)